# krotating

https://open.kattis.com/problems/krotating

Krotating is a segment tree problem. Essentially you have a number of timesteps and have to support two types of query: 0. update the rotations at the given timestep to a new set; 1. Follow the rotations from timestep 0 to a given timestep and return the result. Since the rotations are associative we can use a segment tree to split up the timesteps, and then updating or querying each timestep will be log(m), for a total time complexity of qlog(m). When we do a query we need to walk down the tree until each node is inside our range, apply the rotations, and then pass the new value back up to be used in the subqueries for indexes below us. For updates we need to walk down to the node that represents the given timestep, set the new values, and then pass back up the values of the nodes that have been changed so that we can only recombine those nodes in our parent; Otherwise we would have to do a full recombine at each update, which would degrade us to linear time per query. Also, for recombining changes in left subtrees we need to be able to easily find the node that results in a given number in the right subtree so it's important to also keep a backwards map for each node.